version = "10"

configure(subprojects.findAll { it.name != "common" && it.name != "modlauncher" }) {
    version = parent.version

    configurations {
        bundle
    }

    dependencies {
        bundle(implementation(parent.project("common")))
        if (project.name.startsWith("modlauncher")) {
            bundle(compileOnly(parent.project("modlauncher")))
        }
    }

    jar {
        dependsOn configurations.bundle
        from { configurations.bundle.collect { zipTree(it) } }

        def version = provider { project.version }
        inputs.property("project.version", version)
        manifest {
            attributes("Name": "gg/essential/loader/stage1/")
            attributes("Implementation-Version": version)
        }
    }

}
